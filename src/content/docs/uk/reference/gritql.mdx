---
title: GritQL
description: Основне використання GritQL в Biome
---

GritQL - це мова запитів для виконання структурного пошуку по вихідному коду.
Це означає, що такі дрібниці, як пробіли або навіть тип лапок, що використовуються в
рядках, будуть ігноруватися у вашому пошуковому запиті. Крім того, вона пропонує багато
функцій, які дозволяють запитувати синтаксичну структуру, таку як фрагменти, співставлення,
вкладеність та змінні.

GritQL є [відкритим вихідним кодом](https://github.com/getgrit/gritql/) і створений [Grit.io](https://grit.io/).

Biome використовує GritQL для двох цілей:

- [Плагіни аналізатора](/linter/plugins).
- Команда [`biome search`](/reference/cli/#biome-search), яку ми сподіваємося розширити
  і на наші розширення для IDE.

## Патерни

Запити GritQL працюють через _патерни_. Найбільш поширений патерн, який ви побачите, -
це фрагмент коду, який виглядає як звичайний вихідний код, укладений у зворотні лапки:

```grit
`console.log('Привіт, світ!')`
```

Цей патерн буде відповідати будь-якому виклику `console.log()`, якому передається рядок
`'Привіт, світ!'`. Але оскільки GritQL виконує _структурне_ співставлення, він не
дбає про деталі форматування. Це також відповідає:

```js
console.log (
    'Привіт, світ!'
)
```

І це теж (зверніть увагу на зміну лапок):

```js
console.log("Привіт, світ!")
```

:::note
Більшість оболонок інтерпретують зворотні лапки як виклики команд, що конфліктує з
фрагментами коду GritQL. Тому при використанні команди `biome search` краще за все
укладати ваші запити Grit в _одинарні лапки_:

```shell
biome search '`console.log($message)`' # знайти всі виклики `console.log`
```
:::

## Змінні

Запити GritQL також можуть містити _змінні_. Наступне буде відповідати будь-якому виклику
`console.log()` незалежно від переданого повідомлення:

```grit
`console.log($message)`
```

Це також буде відповідати будь-якому з методів об'єкта `console`:

```grit
`console.$method($message)`
```

Одне і те ж ім'я змінної може зустрічатися кілька разів в одному фрагменті:

```grit
`$fn && $fn()`
```

Це буде відповідати `foo && foo()`, і навіть `foo.bar && foo.bar()`, але не
`foo && bar()`.

## Умови

Ви можете додавати умови до патернів, використовуючи оператор `where`. Він
зазвичай використовується разом з _оператором співставлення_, `<:`:

```grit
`console.$method($message)` where {
    $method <: `log`
}
```

Цей запит ідентичний патерну `console.log($message)`, який ми бачили раніше,
але він швидко стає більш цікавим, коли ми додаємо інші оператори:

```grit
`console.$method($message)` where {
    $method <: or { `log`, `info`, `warn`, `error` }
}
```

## Зіставлення нативних вузлів AST

Двигун GritQL в Biome побудований на основі власних парсерів. Це дозволяє вам писати патерни, які безпосередньо зіставляються з нативними вузлами абстрактного синтаксичного дерева (AST) Biome, пропонуючи більш точну альтернативу загальним, сумісним з TreeSitter патернам.

Нативні вузли AST Biome ідентифікуються за їхніми іменами в `PascalCase` (наприклад, `JsIfStatement`), що відрізняє їх від сумісних з TreeSitter патернів у `snake_case` (наприклад, `if_statement`).

Наприклад, ви можете зіставити оператор `if` в JavaScript, використовуючи будь-який з патернів:

```grit
engine biome(1.0)
language js(typescript,jsx)

or {
  // Патерн, сумісний з TreeSitter
  if_statement(),

  // Патерн нативного вузла AST Biome
  JsIfStatement()
} as $stmt where {
  register_diagnostic(
    span=$stmt,
    message="Знайдено оператор if"
  )
}
```

Використання нативних вузлів AST є дуже ефективним, коли вам потрібні конкретні та продуктивні запити. Наприклад, деякі мовні конструкції, що розпізнаються Biome, можуть не мати прямого еквівалента в загальних патернах `snake_case`. Пряме зіставлення з вузлом AST гарантує, що ви націлені саме на ту структуру, яку ви маєте намір.

Ви можете знайти повний список доступних вузлів AST для кожної мови, вивчивши файли `.ungram` у каталозі [`xtask/codegen`](https://github.com/biomejs/biome/tree/main/xtask/codegen) репозиторію Biome.

## Документація по мові

Для отримання додаткової інформації про GritQL та його синтаксис див. офіційну
[Документацію по мові GritQL](https://docs.grit.io/language/overview).

Будь ласка, майте на увазі, що Biome (поки що) не підтримує всі функції Grit.

## Статус інтеграції

Підтримка GritQL в Biome активно розробляється. Багато що вже працює,
але все ще очікуються помилки, а деякі функції все ще відсутні.

Для детального огляду того, які функції GritQL підтримуються, а які ще
знаходяться в розробці, див. проблему на GitHub:
https://github.com/biomejs/biome/issues/2582.

У нас також є детальний RFC, який визначає напрямок наших зусиль зі створення плагінів:
https://github.com/biomejs/biome/discussions/1762

**tl;dr**: Ми працюємо над підтримкою плагінів, які можуть бути як чисто GritQL
плагінами, так і плагінами JS/TS, які використовують GritQL для вибору коду, з яким вони хочуть працювати.
Слідкуйте за оновленнями!